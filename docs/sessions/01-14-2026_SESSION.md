# Session: 2026-01-14

## Issue: Model Output Format Not Strictly Enforced

**Problem**: Mistral 7B responses missing required format tags (`[COMPLEXITY: X]`, `<thinking depth="N">`, `<realizations>`, `[SALIENCY: X]`), causing null scores in batch fermentation. Evidence: `initialization_1.json` shows `complexity_score: null`, `saliency_score: null`, `realizations: []`.

**Root Cause**: Two-tier output system—unstructured prompting (current) vs. structured output via Outlines.dev (disabled). Unstructured path relies on Mistral tagging discipline; Mistral ignores tags. Regex fallback silently accepts malformed output with null defaults.

### Investigation Approach

1. **Parallel agent reconnaissance**:
   - debug-investigator (client-side): Traced realizationExtractor.js → found three independent realization parsers (fermenter, repl, core), minor strictness variance
   - debug-investigator (server-side): Located yeast-agent.js → system_prompt.md contains explicit format instructions → Outlines.dev schema exists but **disabled by default** (`OUTLINES_ENABLED=false`)

2. **Key Findings**:
   - System prompt explicitly tells Mistral: output `[COMPLEXITY: X]`, `<thinking depth="N">...</thinking>`, `<realizations>...</realizations>`, `[SALIENCY: X]`
   - Outlines.dev schema enforces JSON with 5 required fields: complexity_score, thinking_blocks, realizations, response, saliency_score
   - Config default: `OUTLINES_ENABLED=false`, endpoint: `http://localhost:6789/chat`
   - Fallback parsing: Defaults to 0.5 saliency if `[SALIENCY: X]` missing, null if complexity tag missing

### Attempted Fix

1. **Phase 1 (Validation)**: Confirmed null scores in initialization_1.json ✓
2. **Phase 2 (Server Start)**:
   - Located outlines-server.py at `/home/jay/scripts/outlines-server.py` on apollo.local (not in expected `~/ai-yeast/scripts/`)
   - Started Outlines service: Health check passed (`ollama_ready: true`, `outlines_available: true`) ✓
3. **Phase 3 (Config)**: OUTLINES_ENABLED=true set locally ✓
4. **Phase 3.5 (Deploy)**: Ran deploy-to-apollo.sh → reported "✓ Configuration deployed" ✓
5. **Phase 4 (Validation Test)**:
   - Executed: `npm start -- -p "Test message"`
   - Result: **Process hung indefinitely** ✗
   - Investigation stopped to prevent spiral; processes killed

### Blocker

**Unclear deployment state**:
- Did `.env` with `OUTLINES_ENABLED=true` actually land on apollo.local's home directory?
- Is yeast-agent.js crashing on startup or hanging trying to reach Outlines API?
- No error logs checked yet; need to verify before resuming.

### Next Steps to Unblock

1. Verify config actually deployed: `ssh apollo.local "cat ~/.env | grep OUTLINES_ENABLED"`
2. Check for yeast-agent.js error logs on apollo.local
3. Verify Outlines API reachability from yeast-agent.js process
4. If config deployed correctly, re-test validation query with error inspection

### Branch & Status

- Changes on `01-10-2026-alpha` (merged from 01-10 session)
- No new commits tonight (validation test blocked)
- Ready to resume once deployment verified
